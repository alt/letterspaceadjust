%%
%% This is file `letterspaceadjust.sty',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% letterspaceadjust.dtx  (with options: `package')
%% 
%% EXPERIMENTAL CODE
%% 
%% This package is copyright © 2013 Arno L. Trautmann. It may be distributed and/or
%% modified under the conditions of the LaTeX Project Public License, either version 1.3c
%% of this license or (at your option) any later version. This work has the LPPL mainten-
%% ance status ‘maintained’.
\ProvidesPackage{letterspaceadjust}%
  [2013/03/10 v0.0a letterspaceadjust package]
\input{luatexbase.sty}
\directlua{dofile(kpse.find_file("letterspaceadjust.lua"))}
\def\letterspaceadjust{\directlua{luatexbase.add_to_callback(%
  "pre_linebreak_filter",letterspaceadjust,"letterspaceadjust")}}
\def\unletterspaceadjust{
  \directlua{luatexbase.remove_from_callback("pre_linebreak_filter","letterspaceadjust")}}
\let\stealsheep\letterspaceadjust     %% synonym in honor of Paul
\let\unstealsheep\unletterspaceadjust
\let\returnsheep\unletterspaceadjust
\newluatexattribute\letterspaceadjustattr

\long\def\textletterspaceadjust#1{
  \setluatexattribute\letterspaceadjustattr{42}#1\unsetluatexattribute\letterspaceadjustattr
  \directlua{
    if (textletterspaceadjustactive) then else % -- if already active, do nothing
      luatexbase.add_to_callback(
        "pre_linebreak_filter",textletterspaceadjust,"textletterspaceadjust")
    end
    textletterspaceadjustactive = true         % -- set to active
  }
}
\let\textlsa\textletterspaceadjust
\def\lsamicrostretch#1{\microtypesetup{stretch=#1}}
\def\lsamicroshrink#1{\microtypesetup{shrink=#1}}
\def\lsaemergency#1{\emergencystretch=#1}
\def\lsastretch#1{%
  \directlua{letterspace_spec.stretch = tex.sp"#1"}%
}
%% 
%%
%% End of file `letterspaceadjust.sty'.
